---
title: "Centralized Email Bounce & DSN Collection with Mailcow + Amazon SES 📬"
publishDate: "2025-10-06 00:00:00"
img: /assets/mail-dsn.png
img_alt: Mailcow + Amazon SES centralized bounce handling
description: |
  A complete blueprint for collecting Delivery Status Notifications (DSNs) and bounce messages from Postfix, Dovecot, and Amazon SES into one central mailbox. Improve visibility, simplify troubleshooting, and meet compliance‑retention requirements with a unified DSN workflow.
tags:
  - Mailcow
  - Postfix
  - Dovecot
  - Amazon SES
  - Email
  - Bounces
  - Compliance
---

---

## Why This Project?

Monitoring mail queues alone doesn’t ensure successful message delivery.  
Emails can fail silently — blocked by providers, rejected on policy grounds, or quarantined downstream.

Centralizing **Delivery Status Notifications (DSNs)** offers real‑time visibility into delivery failures across both internal and external MTAs.

---

## Project Goal 🎯

Create a **self‑contained DSN collection system** that:

- Captures **local bounces** generated by Postfix.  
- Collects **remote DSNs** from external providers (e.g., Gmail, Outlook).  
- Integrates **Amazon SES feedback forwarding** for hosted senders.  
- Consolidates everything into one searchable mailbox for operations staff.

Result → a single, auditable timeline of all delivery events.

---

## System Design

| Component | Function | Technology |
|------------|-----------|-------------|
| Postfix | Generate local DSNs, mirror them to audit mailbox | `sender_bcc_maps` |
| Dovecot | Copy inbound DSNs from outside | Global Sieve rule |
| Amazon SES | Forward external bounce reports | Feedback forwarding |
| Central Mailbox | Stores all DSNs for review | `dsn-monitor@example.org` |

```
External MTAs ─┬─► Amazon SES ─┬─► Mailcow/Postfix ─► Dovecot Sieve ─► DSN Mailbox
               │               │
               └───────────────┘      (Central Bounce Collection)
```

---

## Implementation

### 1️⃣ Postfix – Local DSN Redirect

**Extra configuration**
```text
sender_bcc_maps = hash:/opt/postfix/conf/sender_bcc
```

**Mapping**
```text
<> dsn-monitor@example.org
```

**Activate**
```bash
docker exec -it mailcowdockerized-postfix-mailcow-1 postmap /opt/postfix/conf/sender_bcc
docker compose restart postfix-mailcow
```

🟢 *Effect:*  
Any bounce message generated locally (`MAIL FROM <>`) is BCC’d to the central DSN mailbox.

---

### 2️⃣ Dovecot – Global Sieve Rule for Inbound DSNs

**File:** `/opt/mailcow-dockerized/data/conf/dovecot/global_sieve_after`

```text
require ["fileinto", "mailbox", "variables", "subaddress",
         "envelope", "duplicate", "copy"];

# Redirect inbound DSNs to the monitoring mailbox
if allof (
  anyof (
    header :contains "Content-Type" "report-type=delivery-status",
    header :contains "From" "MAILER-DAEMON@",
    header :contains "Subject" "Delivery Status Notification"
  ),
  not header :contains "To" "dsn-monitor@example.org"
) {
  redirect :copy "dsn-monitor@example.org";
  keep;
}
```

**Compile + reload**
```bash
docker exec -it mailcowdockerized-dovecot-mailcow-1 sievec /opt/mailcow-dockerized/data/conf/dovecot/global_sieve_after
docker compose restart dovecot-mailcow
```

🟢 *Effect:*  
All inbound DSNs are copied to the operations mailbox while still being delivered to the original recipient.

---

### 3️⃣ Amazon SES – Feedback Forwarding

1. In the SES Console → *Verified Identity > domain*  
   Enable **Email feedback forwarding**.  

🟢 *Effect:*  
Amazon SES forwards its own bounce and complaint DSNs back into Mailcow, where Dovecot processes them via the above Sieve rule.

---

## Testing 🧪

| Scenario | Method | Expected Outcome |
|-----------|---------|------------------|
| Local bounce | Send mail to invalid domain (e.g., `.invalid`) | DSN copy appears in central mailbox |
| Remote bounce | Send to fake address at a real provider | Remote DSN arrives and is copied |
| SES bounce | Send via SES to invalid recipient | SES forwards DSN to central box |

**Live log monitoring**
```bash
docker compose logs -f dovecot-mailcow | grep -i dsn-monitor@example.org
```

Expected output:
```
redirect action: forwarded to <dsn-monitor@example.org>
```
(no `discard action` afterwards)

---

## Results 📊

- Local and remote bounces now surface in one inbox.  
- Amazon SES feedback messages are visible alongside internal DSNs.  
- No user‑side configuration required.  
- Operations has a full audit trail of every failed delivery.  

---

## Lessons Learned 💡

- Dovecot’s `keep;` statement is required; otherwise messages are discarded post‑redirect.  
- SES suppression lists confirm feedback reception.  
- Check alias and virtual‑user maps to ensure the DSN mailbox truly exists before deploying.  

---

## Outcome ✅

Centralized DSN collection turns opaque bounce handling into a transparent workflow:

- **Compliance:** verifiable record of every failed delivery.  
- **Reliability:** immediate detection of reputation or DNS issues.  
- **Simplicity:** one mailbox; no per‑user filtering needed.  

Cost: negligible (mostly storage).  
Impact: total visibility across all delivery vectors.

---

## Final Thoughts

Email reliability depends on feedback visibility.  
By unifying Postfix, Dovecot, and SES notifications, this design gives system admins direct awareness of every rejection in the delivery path.

Try implementing it in your Mailcow stack — the insight it delivers is worth the few extra lines of configuration :)