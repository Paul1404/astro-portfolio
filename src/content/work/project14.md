---
title: "Centralized Email Bounce & DSN Collection with Mailcowâ€¯+â€¯Amazonâ€¯SES ğŸ“¬"
publishDate: "2025-10-06 00:00:00"
img: /assets/mail-dsn.png
img_alt: Mailcow + Amazonâ€¯SES centralized bounce handling
description: |
  A complete blueprint for collecting Delivery Status Notifications (DSNs) and bounce messages from Postfix, Dovecot, and Amazonâ€¯SES into one central mailbox. Improve visibility, simplify troubleshooting, and meet complianceâ€‘retention requirements with a unified DSN workflow.
tags:
  - Mailcow
  - Postfix
  - Dovecot
  - Amazonâ€¯SES
  - Email
  - Bounces
  - Compliance
---

---

## Why This Project?

Monitoring mail queues alone doesnâ€™t ensure successful message delivery.  
Emails can fail silently â€” blocked by providers, rejected on policy grounds, or quarantined downstream.

Centralizing **Deliveryâ€¯Statusâ€¯Notifications (DSNs)** offers realâ€‘time visibility into delivery failures across both internal and external MTAs.

---

## Project Goal ğŸ¯

Create a **selfâ€‘contained DSN collection system** that:

- Captures **local bounces** generated by Postfix.  
- Collects **remote DSNs** from external providers (e.g., Gmail,â€¯Outlook).  
- Integrates **Amazonâ€¯SES feedback forwarding** for hosted senders.  
- Consolidates everything into one searchable mailbox for operations staff.

Result â†’ a single, auditable timeline of all delivery events.

---

## System Design

| Component | Function | Technology |
|------------|-----------|-------------|
| Postfix | Generate local DSNs, mirror them to audit mailbox | `sender_bcc_maps` |
| Dovecot | Copy inbound DSNs from outside | Globalâ€¯Sieveâ€¯rule |
| Amazonâ€¯SES | Forward external bounce reports | Feedbackâ€¯forwarding |
| Central Mailbox | Stores all DSNs for review | `dsn-monitor@example.org` |

```
External MTAs â”€â”¬â”€â–º Amazonâ€¯SES â”€â”¬â”€â–º Mailcow/Postfix â”€â–º Dovecotâ€¯Sieve â”€â–º DSNâ€¯Mailbox
               â”‚               â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      (Central Bounce Collection)
```

---

## Implementation

### 1ï¸âƒ£â€¯Postfixâ€¯â€“â€¯Localâ€¯DSNâ€¯Redirect

**Extra configuration**
```text
sender_bcc_maps = hash:/opt/postfix/conf/sender_bcc
```

**Mapping**
```text
<> dsn-monitor@example.org
```

**Activate**
```bash
docker exec -it mailcowdockerized-postfix-mailcow-1 postmap /opt/postfix/conf/sender_bcc
docker compose restart postfix-mailcow
```

ğŸŸ¢ *Effect:*  
Any bounce message generated locally (`MAILâ€¯FROMâ€¯<>`) is BCCâ€™d to the central DSN mailbox.

---

### 2ï¸âƒ£â€¯Dovecotâ€¯â€“â€¯Globalâ€¯Sieveâ€¯Ruleâ€¯forâ€¯Inboundâ€¯DSNs

**File:** `/opt/mailcow-dockerized/data/conf/dovecot/global_sieve_after`

```text
require ["fileinto", "mailbox", "variables", "subaddress",
         "envelope", "duplicate", "copy"];

# Redirect inbound DSNs to the monitoring mailbox
if allof (
  anyof (
    header :contains "Content-Type" "report-type=delivery-status",
    header :contains "From" "MAILER-DAEMON@",
    header :contains "Subject" "Delivery Status Notification"
  ),
  not header :contains "To" "dsn-monitor@example.org"
) {
  redirect :copy "dsn-monitor@example.org";
  keep;
}
```

**Compileâ€¯+â€¯reload**
```bash
docker exec -it mailcowdockerized-dovecot-mailcow-1 sievec /opt/mailcow-dockerized/data/conf/dovecot/global_sieve_after
docker compose restart dovecot-mailcow
```

ğŸŸ¢ *Effect:*  
All inbound DSNs are copied to the operations mailbox while still being delivered to the original recipient.

---

### 3ï¸âƒ£â€¯Amazonâ€¯SESâ€¯â€“â€¯Feedbackâ€¯Forwarding

1. In the SESâ€¯Console â†’â€¯*Verifiedâ€¯Identityâ€¯>â€¯domain*  
   Enable **Emailâ€¯feedbackâ€¯forwarding**.  

ğŸŸ¢ *Effect:*  
Amazonâ€¯SES forwards its own bounce and complaint DSNs back into Mailcow, where Dovecot processes them via the above Sieve rule.

---

## Testing ğŸ§ª

| Scenario | Method | Expected Outcome |
|-----------|---------|------------------|
| Localâ€¯bounce | Send mail to invalid domain (e.g., `.invalid`) | DSN copy appears in central mailbox |
| Remoteâ€¯bounce | Send to fake address at a real provider | Remote DSN arrives and is copied |
| SESâ€¯bounce | Send via SES to invalid recipient | SES forwards DSN to central box |

**Live log monitoring**
```bash
docker compose logs -f dovecot-mailcow | grep -i dsn-monitor@example.org
```

Expected output:
```
redirect action: forwarded to <dsn-monitor@example.org>
```
(no `discard action` afterwards)

---

## Results ğŸ“Š

- Local and remote bounces now surface in one inbox.  
- Amazonâ€¯SES feedback messages are visible alongside internal DSNs.  
- No userâ€‘side configuration required.  
- Operations has a full audit trail of every failed delivery.  

---

## Lessonsâ€¯Learned ğŸ’¡

- Dovecotâ€™s `keep;` statement is required; otherwise messages are discarded postâ€‘redirect.  
- SES suppression lists confirm feedback reception.  
- Check alias and virtualâ€‘user maps to ensure the DSN mailbox truly exists before deploying.  

---

## Outcome âœ…

Centralized DSN collection turns opaque bounce handling into a transparent workflow:

- **Compliance:** verifiable record of every failed delivery.  
- **Reliability:** immediate detection of reputation or DNS issues.  
- **Simplicity:** one mailbox; no perâ€‘user filtering needed.  

Cost: negligible (mostly storage).  
Impact: total visibility across all delivery vectors.

---

## Final Thoughts

Email reliability depends on feedback visibility.  
By unifying Postfix, Dovecot, and SES notifications, this design gives system admins direct awareness of every rejection in the delivery path.

Try implementing it in your Mailcow stack â€” the insight it delivers is worth the few extra lines of configuration :)